<apex:page controller="AI_JobSummaryPageController" contentType="text/html" applyBodyTag="false" >

    <html>
    <body>
        <div class="fr-responsive"  style="font-family:'Segoe UI',Arial,sans-serif;color:#333;line-height:1.6;max-width:900px;margin:auto;padding:30px;background:#fafafa;">
            <style>
                @media screen and (max-width: 600px){ 
                    .fr-responsive {padding: 0px !important;} 
                    .fr-responsive .sub-section {padding: 12px !important;} 
                }
            </style>

            <div class="sub-section"  style="background:#ffffff;padding:25px;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,0.08);">

                <h1 style="color:#0f172a;font-size:26px;margin-bottom:5px;">Job Summary Report</h1>

                <p style="font-size:13px;color:#555;margin-top:0;margin-bottom:15px;">
                    {!Label['ReportDate']}: 
                    <apex:outputText value="{0, date, MMMM d',' yyyy}">
                        <apex:param value="{!ReportDate}" /> 
                    </apex:outputText>
                </p>

                <hr style="border:0;border-top:1px solid #e2e8f0;margin:20px 0;" />

                <!-- Job Overview -->
                <h2 style="color:#1e293b;font-size:18px;margin-bottom:8px;">{!Label['JobOverviewTitle']}</h2>
                <table style="width:100%;border-collapse:collapse;font-size:14px;margin-bottom:15px;">
                    <tbody>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['JobName']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">{!JobOverview['JobName']}</td>
                        </tr>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['Status']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">{!JobOverview['Status']}</td>
                        </tr>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['Location']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">{!JobOverview['Location']}</td>
                        </tr>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['ContractPrice']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">₹{!JobOverview['ContractPrice']}</td>
                        </tr>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['TotalManHoursLogged']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">{!JobOverview['TotalManHoursLogged']} hrs</td>
                        </tr>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['TotalContractValue']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">₹{!JobOverview['TotalContractValue']}</td>
                        </tr>
                        <tr>
                            <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['Mobilizations']}</td>
                            <td style="padding:8px;border:1px solid #ddd;">{!JobOverview['Mobilizations']}</td>
                        </tr>
                    </tbody>
                </table>

                <hr style="border:0;border-top:1px solid #e2e8f0;margin:30px 0;" />

                <!-- Work Progress Summary -->
                <h2 style="color:#1e293b;font-size:18px;">{!Label['WorkProgressSummaryTitle']}</h2>
                <p style="margin-top:5px;font-size:14px;"><strong>{!Label['GroupedByWorkDates']}</strong></p>

                <table style="width:100%;border-collapse:collapse;font-size:14px;margin-top:5px;">
                    <apex:outputpanel rendered="{!EachLogSummary != null}">
                    <tr>
                        <th style="padding:10px;border:1px solid #ddd;background:#f1f5f9;text-align:left;">{!Label['Date']}</th>
                        <th style="padding:10px;border:1px solid #ddd;background:#f1f5f9;text-align:left;">{!Label['SummaryOfKeyWorkActivities']}</th>
                    </tr>
                        <apex:repeat value="{!EachLogSummary}" var="log">
                            <tr>
                                <td style="padding:8px;border:1px solid #ddd;white-space: pre;">{!log['Date']}</td>
                                <td style="padding:8px;border:1px solid #ddd;">{!log['SummaryOfKeyWorkActivities']}</td>
                            </tr>
                        </apex:repeat>
                    </apex:outputpanel>
                    <apex:outputpanel rendered="{!EachLogSummary == null}">
                        <tr>
                            <td colspan="2" style="padding:8px;border:1px solid #ddd;text-align:center;color:#888;">No work log summaries available.</td>
                        </tr>
                    </apex:outputpanel>
                </table>

                <apex:outputpanel rendered="{!ShiftLogSummary['ExceptionOverallSummary'] != ''}">
                    <p style="font-size:14px;margin-top:12px;">
                        <strong>{!Label['OverallWorkSummary']}:</strong><br/>{!ShiftLogSummary['ExceptionOverallSummary']}
                    </p>
                </apex:outputpanel>

                <hr style="border:0;border-top:1px solid #e2e8f0;margin:30px 0;" />

                <!-- Exceptions -->
                <h2 style="color:#1e293b;font-size:18px;">{!Label['ExceptionsChallengesTitle']}</h2>
                <table style="width:100%;border-collapse:collapse;font-size:14px;">
                    <apex:outputpanel rendered="{!EachLogSummary != null}">
                        <tr>
                            <th style="padding:10px;border:1px solid #ddd;background:#f1f5f9;text-align:left;">{!Label['Date']}</th>
                            <th style="padding:10px;border:1px solid #ddd;background:#f1f5f9;text-align:left;">{!Label['ExceptionCause']}</th>
                        </tr>
                        <apex:repeat value="{!EachLogSummary}" var="log2">
                            <tr>
                                <td style="padding:8px;border:1px solid #ddd;white-space: pre;">{!log2['Date']}</td>
                                <td style="padding:8px;border:1px solid #ddd;">{!log2['ExceptionCause']}</td>
                            </tr>
                        </apex:repeat>
                    </apex:outputpanel>
                    <apex:outputpanel rendered="{!EachLogSummary == null}">
                        <tr>
                            <td colspan="2" style="padding:8px;border:1px solid #ddd;text-align:center;color:#888;">No work log summaries available.</td>
                        </tr>
                    </apex:outputpanel>
                </table>
                <apex:outputpanel rendered="{!ShiftLogSummary['ExceptionOverallSummary'] != ''}">
                    <p style="font-size:14px;margin-top:12px;">
                        <strong>{!Label['ExceptionOverallSummary']}: </strong><br/>{!ShiftLogSummary['ExceptionOverallSummary']}
                    </p>
                </apex:outputpanel>

                <hr style="border:0;border-top:1px solid #e2e8f0;margin:30px 0;" />

                <!-- Notes -->
                <h2 style="color:#1e293b;font-size:18px;">{!Label['NotesForOfficeTitle']}</h2>
                <apex:outputpanel rendered="{!ShiftLogSummary['ExceptionOverallSummary'] != null}">
                    <ul style="font-size:14px;margin-top:5px;padding-left:20px;">
                        <apex:repeat value="{!NotesForOffice}" var="note">
                            <li style="margin-bottom:4px;list-style:disc;">{!note}</li>
                        </apex:repeat>
                    </ul>
                </apex:outputpanel>
                <apex:outputpanel rendered="{!ShiftLogSummary['ExceptionOverallSummary'] == null}">
                    <p style="font-size:14px;color:#888;margin-top:5px;">No notes available for office.</p>
                </apex:outputpanel>

                <hr style="border:0;border-top:1px solid #e2e8f0;margin:30px 0;" />

                <!-- Job Health -->
                <h2 style="color:#1e293b;font-size:18px;">{!Label['OverallJobHealthSummaryTitle']}</h2>
                <table style="width:100%;border-collapse:collapse;font-size:14px;">
                    <tr>
                        <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['ScheduleProgress']}</td>
                        <td style="padding:8px;border:1px solid #ddd;">{!OverallJobHealthSummary['Progress']}</td>
                    </tr>
                    <tr>
                        <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['CommunicationEfficiency']}</td>
                        <td style="padding:8px;border:1px solid #ddd;">{!OverallJobHealthSummary['Efficiency']}</td>
                    </tr>
                    <tr>
                        <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['ResourceUtilization']}</td>
                        <td style="padding:8px;border:1px solid #ddd;">{!OverallJobHealthSummary['ResourceUtilization']}</td>
                    </tr>
                    <tr>
                        <td style="padding:8px;border:1px solid #ddd;background:#f9fafb;font-weight:bold;">{!Label['DocumentationStatus']}</td>
                        <td style="padding:8px;border:1px solid #ddd;">{!OverallJobHealthSummary['Status']}</td>
                    </tr>
                </table>

                <hr style="border:0;border-top:1px solid #e2e8f0;margin:30px 0;" />

                <!-- Final Summary -->
                <h2 style="color:#1e293b;font-size:18px;">{!Label['FinalSummaryTitle']}</h2>
                <p style="font-size:14px;margin: auto;">{!FinalSummary}</p>

            </div>
        </div>
    </body>
    </html>

</apex:page>
