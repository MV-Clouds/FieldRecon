<template>

    <div class="spinner-container slds-is-fixed" if:true={isLoading}>
        <lightning-spinner alternative-text="Loading..." size="medium"></lightning-spinner>
    </div>

    <div class="header-info slds-m-bottom_medium">
        <h1 class="title slds-grid slds-grid_vertical-align-center">
            <!-- <svg viewBox="0 0 24 24" class="slds-m-right_x-small"><path d="M16.9337 8.96494C16.426 5.03562 13.0675 2 9 2 4.58172 2 1 5.58172 1 10 1 11.8924 1.65707 13.6313 2.7555 15.0011 3.56351 16.0087 4.00033 17.1252 4.00025 18.3061L4 22H13L13.001 19H15C16.1046 19 17 18.1046 17 17V14.071L18.9593 13.2317C19.3025 13.0847 19.3324 12.7367 19.1842 12.5037L16.9337 8.96494ZM3 10C3 6.68629 5.68629 4 9 4 12.0243 4 14.5665 6.25141 14.9501 9.22118L15.0072 9.66262 16.5497 12.0881 15 12.7519V17H11.0017L11.0007 20H6.00013L6.00025 18.3063C6.00036 16.6672 5.40965 15.114 4.31578 13.7499 3.46818 12.6929 3 11.3849 3 10ZM21.1535 18.1024 19.4893 16.9929C20.4436 15.5642 21 13.8471 21 12.0001 21 10.153 20.4436 8.4359 19.4893 7.00722L21.1535 5.89771C22.32 7.64386 23 9.74254 23 12.0001 23 14.2576 22.32 16.3562 21.1535 18.1024Z"></path></svg> -->
            <svg viewBox="0 0 24 24" class="slds-m-right_x-small"><path d="M20.4668 7.69379L20.7134 7.12811C21.1529 6.11947 21.9445 5.31641 22.9323 4.87708L23.6919 4.53922C24.1027 4.35653 24.1027 3.75881 23.6919 3.57612L22.9748 3.25714C21.9616 2.80651 21.1558 1.97373 20.7238 0.930828L20.4706 0.319534C20.2942 -0.106511 19.7058 -0.106511 19.5293 0.319534L19.2761 0.930828C18.8442 1.97373 18.0384 2.80651 17.0252 3.25714L16.308 3.57612C15.8973 3.75881 15.8973 4.35653 16.308 4.53922L17.0677 4.87708C18.0555 5.31641 18.8471 6.11947 19.2866 7.12811L19.5331 7.69379C19.7136 8.10792 20.2864 8.10792 20.4668 7.69379ZM14.3869 5.33879C14.661 5.77254 15.0357 6.09305 15.5111 6.30032L16.0764 6.54679C16.4565 6.71249 16.7643 6.94524 16.9998 7.24503V10C16.9998 12.7614 14.7612 15 11.9998 15C9.23833 15 6.99976 12.7614 6.99976 10V6C6.99976 3.23858 9.23833 1 11.9998 1C13.1238 1 14.1613 1.37094 14.9964 1.99709C14.7563 2.17678 14.5531 2.39813 14.3869 2.66114C14.129 3.06938 14 3.51566 14 3.99997C14 4.48428 14.129 4.93056 14.3869 5.33879ZM3.05469 11H5.07065C5.55588 14.3923 8.47329 17 11.9998 17C15.5262 17 18.4436 14.3923 18.9289 11H20.9448C20.4837 15.1716 17.1714 18.4839 12.9998 18.9451V23H10.9998V18.9451C6.82814 18.4839 3.51584 15.1716 3.05469 11Z"></path></svg>
            Work Log Activity Recorder
        </h1>
        <p class="sub-info">Record work logs anytime during the day using your voice command. Work Performed, Plan for Tomorrow, Exceptions, or Notes to Office.</p>
    </div>

    <!-- <div lwc:if={limitExceeded} class="slds-text-color_error slds-m-vertical_xx-small">Your Today's Shift Logs Recoding Limit Exceeded. You can't capture more shift log via recoding!</div> -->
    <c-cmp_audio-recorder class="recording-section slds-m-vertical_large" max-time="180" data-name="audioRecorder" onsave={handleSaveRecoding} disabled={limitExceeded}></c-cmp_audio-recorder>

    <div class="clip-list-section slds-p-bottom_x-small">
        <div class="log-list slds-m-vertical_large slds-grid slds-grid_vertical-align-center">
            <h2 class="log-list-title">
                <svg viewBox="0 0 24 24" class="slds-m-right_x-small"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM8 7H16V9H8V7ZM8 11H16V13H8V11ZM8 15H13V17H8V15Z"></path></svg>
                Today's Shift Logs
            </h2>
            <p class="total-fileSize">Total Recoding Size: {clipSizeLimits.MB} MB</p>
        </div>
        <template lwc:if={clips.length} for:each={clips} for:item="clip" for:index="index"> 
            <div key={clip.id}>
                <div class="single-clip slds-m-bottom_medium">
                    <div class="single-clip-sub">
                        <div class="clip-info">
                            <div class="slds-grid slds-grid_vertical-align-end slds-m-bottom_x-small" title="Created By">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 22H4V20C4 17.2386 6.23858 15 9 15H15C17.7614 15 20 17.2386 20 20V22ZM12 13C8.68629 13 6 10.3137 6 7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7C18 10.3137 15.3137 13 12 13Z"></path></svg>
                                <p class="slds-m-left_xx-small createdBy-text">{clip.createdByName}</p>
                            </div>
                            <div class="slds-grid slds-grid_vertical-align-center slds-grid_align-spread">
                                <div class="slds-grid slds-grid_vertical-align-center">
                                    <svg viewBox="0 0 24 24" fill="currentColor" title="Created Date"><path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM13 12H17V14H11V7H13V12Z"></path></svg>
                                    <lightning-formatted-date-time class="slds-m-left_xx-small info-text" value={clip.CreatedDate} year="numeric" month="numeric" day="numeric"
                                                 hour="2-digit" minute="2-digit" >
                                    </lightning-formatted-date-time>
                                </div>
                                <div class="slds-grid slds-grid_vertical-align-center slds-m-left_small">
                                    <svg viewBox="0 0 24 24" class="slds-m-right_xx-small" title="File Size"><path d="M5 12.5C5 12.8134 5.46101 13.3584 6.53047 13.8931C7.91405 14.5849 9.87677 15 12 15C14.1232 15 16.0859 14.5849 17.4695 13.8931C18.539 13.3584 19 12.8134 19 12.5V10.3287C17.35 11.3482 14.8273 12 12 12C9.17273 12 6.64996 11.3482 5 10.3287V12.5ZM19 15.3287C17.35 16.3482 14.8273 17 12 17C9.17273 17 6.64996 16.3482 5 15.3287V17.5C5 17.8134 5.46101 18.3584 6.53047 18.8931C7.91405 19.5849 9.87677 20 12 20C14.1232 20 16.0859 19.5849 17.4695 18.8931C18.539 18.3584 19 17.8134 19 17.5V15.3287ZM3 17.5V7.5C3 5.01472 7.02944 3 12 3C16.9706 3 21 5.01472 21 7.5V17.5C21 19.9853 16.9706 22 12 22C7.02944 22 3 19.9853 3 17.5ZM12 10C14.1232 10 16.0859 9.58492 17.4695 8.89313C18.539 8.3584 19 7.81342 19 7.5C19 7.18658 18.539 6.6416 17.4695 6.10687C16.0859 5.41508 14.1232 5 12 5C9.87677 5 7.91405 5.41508 6.53047 6.10687C5.46101 6.6416 5 7.18658 5 7.5C5 7.81342 5.46101 8.3584 6.53047 8.89313C7.91405 9.58492 9.87677 10 12 10Z"></path></svg>
                                    <p class="info-text">{clip.size_mb} MB.....</p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-grid redio-info slds-wrap">
                            <audio class="output-audio" controls preload="metadata">
                                <source src={clip.VersionDataUrl} type="audio/mpeg">
                            </audio>
                            <button class="control-btn delete-btn slds-m-left_small" data-index={index} data-id={clip.Id} onclick={handleDeleteClip} disabled={clip.notMyClip} title="Delete Recording">
                                <svg viewBox="0 0 24 24"><path d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 4V6H15V4H9Z"></path></svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </template>
        <template lwc:else>
            <div class="empty-state slds-m-vertical_small">
                <p class="title">No work log recorded yet.</p>
                <p class="sub-info slds-m-bottom_x-small">Start by adding your first work log entry using your voice command.</p>
            </div>
        </template>
    </div>
</template>