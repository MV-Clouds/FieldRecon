<template>
    <template if:true={isModalVisible}>
        <!-- Modal -->
        <section 
            role="dialog" 
            tabindex="-1" 
            aria-labelledby="modal-heading" 
            aria-modal="true" 
            aria-describedby="modal-content" 
            class={modalClass}
            onkeydown={handleKeyDown}>
            
            <div class="slds-modal__container">
                <!-- Modal Header -->
                <div class="pop-heading" id="modal-heading">
                    {title}
                </div>

                <!-- Modal Body -->
                <div class="slds-modal__content pop-up" id="modal-content">
                    <div class="popUpBody">
                        <div class="modal-message">
                            <lightning-formatted-rich-text value={message}></lightning-formatted-rich-text>
                        </div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="slds-modal__footer modal-footer">
                    <!-- Standard mode (2 buttons) -->
                    <template if:false={showThreeButtons}>
                        <button 
                            class="cancel-btn" 
                            onclick={handleCancel}
                            disabled={isProcessing}>
                            {cancelButtonLabel}
                        </button>
                        
                        <button 
                            class={confirmButtonClass}
                            onclick={handleConfirm}
                            disabled={isProcessing}>
                            <template if:true={isProcessing}>
                                <lightning-spinner 
                                    alternative-text="Processing" 
                                    size="small" 
                                    class="button-spinner">
                                </lightning-spinner>
                            </template>
                            {confirmButtonLabel}
                        </button>
                    </template>

                    <!-- Three button mode for delete options -->
                    <template if:true={showThreeButtons}>
                        <button 
                            class="cancel-btn" 
                            onclick={handleCancel}
                            disabled={isProcessing}>
                            Cancel
                        </button>
                        
                        <button 
                            class="clock-in-button neutral three-button-option" 
                            onclick={handleThirdOption}
                            disabled={isProcessing}>
                            {thirdButtonLabel}
                        </button>

                        <button 
                            class="clock-in-button destructive" 
                            onclick={handleConfirm}
                            disabled={isProcessing}>
                            <template if:true={isProcessing}>
                                <lightning-spinner 
                                    alternative-text="Processing" 
                                    size="small" 
                                    class="button-spinner">
                                </lightning-spinner>
                            </template>
                            {confirmButtonLabel}
                        </button>
                    </template>
                </div>
            </div>
        </section>

        <!-- Backdrop -->
        <div class="slds-backdrop slds-backdrop_open" onclick={handleBackdropClick}></div>
    </template>
</template>